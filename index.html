const newScripts = []; document.querySelectorAll('.script-title').forEach((el) => { const row = el.closest('.setting-card'); const title = row.querySelector('.script-title').value.trim(); const text = row.querySelector('.script-text').value.trim(); if (title && text) newScripts.push({ title, text }); });
        const newFaq = []; document.querySelectorAll('.faq-q').forEach((el) => { const row = el.closest('.setting-card'); const q = row.querySelector('.faq-q').value.trim(); const a = row.querySelector('.faq-a').value.trim(); if (q && a) newFaq.push({ q, a }); });

        const token = document.getElementById('tgTokenInput').value.trim();
        const adminId = document.getElementById('adminIdInput').value.trim();
        const tbToken = document.getElementById('turboTokenInput').value.trim();
        const tbSender = document.getElementById('turboSenderInput').value.trim();

        db.ref('config').update({ managers: newManagers, promos: newPromos, scripts: newScripts, faq: newFaq, tg_token: token, admin_id: adminId, turbo_token: tbToken, turbo_sender: tbSender });
        managers = newManagers; savedPromos = newPromos; savedScripts = newScripts; savedFaq = newFaq; tgBotToken = token; superAdminId = adminId; turboToken = tbToken; turboSender = tbSender;
        
        if(currentChatId) renderQuickScripts();
        closeSettings(); alert('Налаштування збережено!');
    }

    function loadSettings() {
        db.ref('config').once('value', snap => {
            const cfg = snap.val()  {};
            managers = cfg.managers  []; savedPromos = cfg.promos  []; savedScripts = cfg.scripts  []; savedFaq = cfg.faq  [];
            tgBotToken = cfg.tg_token  ""; superAdminId = cfg.admin_id  ""; turboToken = cfg.turbo_token  ""; turboSender = cfg.turbo_sender || "";
            if(currentChatId) renderQuickScripts(); 
        });
    }
</script>

</body>
</html>

